# How to request proof

## Write application and generate inputs

### Install Pico CLI

Install Pico CLI `v1.1.8`.

#### Option 1: Cargo install

Install pico-cli from the GitHub repository:
```
cargo +nightly-2025-08-04 install --git https://github.com/brevis-network/pico --tag v1.1.8 pico-cli
```

Check the version:
```
cargo pico --version
```

#### Option 2: Local install

Git clone Pico-VM repository:
```
git clone https://github.com/brevis-network/pico
```
Switch to tag `v1.1.8`:
```
cd pico
git checkout v1.1.8
```

Install from the local path:
```
cd sdk/cli
cargo install --locked --force --path .
```

### Build application to generate ELF

Reference the [Pico document](https://pico-docs.brevis.network/writing-apps/programs) to write a application program. Then use `cargo pico build` to compile and generate the ELF. 
Reference [Pico Fibonacci](https://github.com/brevis-network/pico/tree/main/perf/bench_apps/fibonacci) as an example.

### Generate VK digest

The VK digest is generated by building the ELF file. It could be generated by using [pico-proving-service gen-app-id](https://github.com/brevis-network/pico-proving-service?tab=readme-ov-file#generate-application-id-locally):
```
# clone and enter pico-proving-service repository
cd pico-proving-service
RUST_LOG=debug VK_VERIFICATION=true cargo run -r --bin gen-app-id -- --elf YOUR_ELF_FILE_PATH
```

### Generate input data

Reference [pico-proving-service gen-input-example](https://github.com/brevis-network/pico-proving-service/blob/main/bin/gen_input_example.rs) to write a program to generate the input data:
```
# clone and enter pico-proving-service repository
cd pico-proving-service

# update `gen_input_example.rs` to write the input data as the ELF code required
# for example, the Fibonacci ELF only `read` an u32, you could write an u32 without other inputs
RUST_LOG=debug cargo run -r --bin gen-input-example
```

### Generate public values digest

The public values digest is generated by the build ELF file and input data. It could be generated by using [pico-proving-service gen-common-pv-digest](https://github.com/brevis-network/pico-proving-service?tab=readme-ov-file#generate-common-public-values-digest-locally):
```
# clone and enter pico-proving-service repository
cd pico-proving-service
RUST_LOG=debug VK_VERIFICATION=true cargo run -r --bin gen-common-pv-digest -- --elf YOUR_ELF_FILE_PATH --inputs YOUR_INPUT_FILE_PATH
```

## Send a proof request

Use [explorer BrevisMarket](https://sepolia.arbiscan.io/address/0x9c19d2De433217FB4b41a5D8d35aB8eE4A7b0DFa#writeProxyContract) to request proof. Follow below instructions to obtain each param of a request.

1. `nonce`

A unique num to identify a request from you

2. `vk`

Reference [Generate VK digest](#generate-vk-digest) for details.

3. `publicValuesDigest`

Reference [Generate public values digest](#generate-public-values-digest) for details.

4. `imgURL`

Reference [Build application to generate ELF](#build-application-to-generate-elf), then upload the ELF file to this image URL.

5. `inputData`

Reference [Generate input data](#generate-input-data) for details.

6. `inputURL`

Reference [Generate input data](#generate-input-data), then upload the input data this input URL if it's large. 
It's optional, either `inputData` or `inputURL` should be provided.

7. `fee`

In tuple [`maxFee`, `minStake`, `deadline`].
`maxFee`, the max fee in staking token (for testnet, it's [testnet staking token](https://sepolia.arbiscan.io/address/0x46b07178907650afc855763a8f83e65afec24074)) you wish to pay for the request.
`minStake`, only the provers that stake more than the value can bid for the request.
`deadline`, the proof should be submitted no later than (in unix seconds), note that the maximum deadline duration from request time can not exceed 30 days.

Note, Before initiate a proof request, you need to use [explorer StakingToken](https://sepolia.arbiscan.io/address/0x46b07178907650afc855763a8f83e65afec24074#writeContract) to approve `BrevisMarket` 0x9c19d2De433217FB4b41a5D8d35aB8eE4A7b0DFa to spend your staking token. Please use [explorer Faucet](https://sepolia.arbiscan.io/address/0x9C4e124141A599482b08492a03c49e26CCA21bAA#writeContract) to get `drip` some [testnet staking token](https://sepolia.arbiscan.io/address/0x46b07178907650afc855763a8f83e65afec24074).

## A tool to send batch requests

1. A tool is provided for sending batch requests. Under `tools` folder in this repo, run `go build` to build the tool.

    ```
    cd tools
    go build
    ```

2. Then update the `config.toml` to fill in below fields in `[chain]` section:

    | Field | Description |
    | ----- | ----------- |
    | keystore | The path to your ethereum account keystore json |
    | passphrase | The passphrase to the keystore |

Update the param values in `[[request]]` section accordingly. Provide multile `[[request]]` sections to send multiple requests.

3. Execute below command to send the requsets:

    ```
    ./tools request-proof --config ./config.toml
    ```

## Sample Apps for Testing

The following sample applications are available for testing and benchmarking:

- **[Fibonacci](https://github.com/brevis-network/pico/tree/main/perf/bench_apps/fibonacci)**: Computes the n-th Fibonacci number from a `u32` input using modular arithmetic to prevent overflow. Represents a **light** proving workload suitable for quick validation.
- **[Tendermint](https://github.com/brevis-network/pico/tree/main/examples/tendermint/app)**: Implements a Tendermint light-client verifier that validates consensus updates between two light blocks. Represents a **medium** proving workload for consensus verification.
- **[Reth](https://github.com/brevis-network/pico/tree/main/perf/bench_apps/reth-pico)**: Executes Ethereum block verification using the Reth client executor and commits the resulting block header. Represents a **heavy** proving workload for production block verification.

To build ELF files from these sample apps, use `cargo pico build` as described in Section 4. For input data generation, refer to Section 5.
